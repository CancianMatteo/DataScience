---
title: "Incidenti stradali in Italia"
author: "Matteo Cancian"
date: "26 Giugno 2023"
output: 
  ioslides_presentation: 
    widescreen: true
    slide_width: 1600
    slide_height: 900
    css: 'styles.css'
    
---


## Introduzione e domande

Ho scelto di fare questa analisi per analizzare gli incidenti stradali in Italia.\
Mi sono chiesto infatti quali variabili potesssero incidere positivamente o negativamente sulle possibilità di fare un incidente:

-   Gli incidenti sono rapportati alla popolazione dell'area geografica?

-   Gli incidenti sono rapportati al parco veicolare dell'area geografica?

-   Ci sono più possibilità di fare un incidente ad una certa ora del giorno?

-   Ci sono più possibilità di fare incidenti certi giorni piuttosto che altri?

-   Il tipo di strada percorsa incide su determinati tipi di incidenti?

-   *Il tipo o colore del veicolo varia le possibilità di incidenti?



## Raccolta dati e dataset

Ho analizzato i dataset disponibili su internet di varie organizzazioni (ISTAT, MIT, ACI, OECD...).
Alla fine ho deciso di prendere i dati dall'ISTAT dove erano più completi e affidabili.

Ho estrapolato vari dataset riguardanti il parco veicolare, gli incidenti e la popolazione di dimensione molto variabile (da decine di righe a centinaia di migliaia).
CI ho tolto tutte le cose inutili e li ho adattati alle mie necessità.

<!-- qui magari dopo aggiungici qualche immagine -->



## Incidenti in rapporto alla popolazione per regione

```{r, echo=FALSE, message=FALSE}
source("ImportTidyTransform.R")

source("ggplotIncidentiPopolazione.R")

ggplot(data = RapportoIncidentiPopolazione, mapping = aes(x = Territorio, y = IncidentiPerMlnAbitanti, color = Anno)) +
  geom_point() + 
  theme(axis.text.x=element_text(angle=60, hjust=1, vjust=0.5, margin = margin(t = -50, r = 0, b = 0, l = 0, unit = "pt")))
```




```{r, echo=FALSE, message=FALSE}
ggplot(data = RapportoIncidentiPopolazione %>% filter(Anno==2021), mapping = aes(x = nPopolazione, y = nIncidenti)) +
  geom_point() +
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(se = FALSE)
```



## Mappa incidenti in rapporto alla popolazione per provincia 

```{r, fig.width=7, fig.height=7, echo=FALSE, message=FALSE}
source("MapProvIncidentiPopolazione.R")

# Disegna la mappa con i colori
 ggplot() +
   geom_polygon(data = mappa_italia, aes(x = long, y = lat, group = group, fill = province), color = "black") +
   scale_fill_manual(values = ColoriProvince$colori) +
   theme_void() + theme(legend.position = "none") +     # per togliere assi, ecc dal grafico
   guides(color = guide_colorbar(title = "Valore"))
```



## Incidenti in rapporto al parco veicolare per regione

```{r, echo=FALSE, message=FALSE}
source("ggplotIncidentiParcoveicolare.R")

ggplot(data = RapportoIncidentiVeicoli %>% filter(TIME==2021), mapping = aes(x = nVeicoli, y = nIncidenti)) +
  geom_point() +
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(se = FALSE)
```



## Mappa incidenti in rapporto al parco veicolare per provincia 

```{r, fig.width=7, fig.height=7, echo=FALSE, message=FALSE}
source("MapProvIncidentiParcoveicolare.R")

# Disegna la mappa con i colori
 ggplot() +
   geom_polygon(data = mappa_italia, aes(x = long, y = lat, group = group, fill = province), color = "black") +
   scale_fill_manual(values = ColoriProvince$colori) +
   theme_void() + theme(legend.position = "none") +     # per togliere assi, ecc dal grafico
   guides(color = guide_colorbar(title = "Valore"))
```

