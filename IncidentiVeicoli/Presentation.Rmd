---
title: "Incidenti stradali in Italia"
author: "Matteo Cancian"
date: "26 Giugno 2023"
output: 
  ioslides_presentation: 
    widescreen: true
    slide_width: 1600
    slide_height: 900
    
---
<style> slides > slide { overflow: auto; }</style>

## Introduzione e domande

Ho scelto di fare questa analisi per analizzare gli incidenti stradali in Italia.\
Mi sono chiesto infatti quali variabili potesssero incidere positivamente o negativamente sulle possibilità di fare un incidente:

-   Gli incidenti sono rapportati alla popolazione dell'area geografica?

-   Gli incidenti sono rapportati al parco veicolare dell'area geografica?

-   Ci sono più possibilità di fare un incidente ad una certa ora del giorno?

-   Ci sono più possibilità di fare incidenti certi giorni piuttosto che altri?

-   Il tipo di strada percorsa incide su determinati tipi di incidenti?

-   *Il tipo o colore del veicolo varia le possibilità di incidenti?



## Raccolta dati e dataset

Ho analizzato i dataset disponibili su internet di varie organizzazioni (ISTAT, MIT, ACI, OECD...).
Alla fine ho deciso di prendere i dati dall'ISTAT dove erano più completi e affidabili.

Ho estrapolato vari dataset riguardanti il parco veicolare, gli incidenti e la popolazione di dimensione molto variabile (da decine di righe a centinaia di migliaia).
CI ho tolto tutte le cose inutili e li ho adattati alle mie necessità.

<!-- qui magari dopo aggiungici qualche immagine -->



## Incidenti in rapporto alla popolazione per regione

```{r, fig.width=9, fig.height=6, echo=FALSE, message=FALSE}
source("ImportTidyTransform.R")
source("ggplotIncidentiPopolazione.R")

ggplot(data = RapportoIncidentiPopolazione, mapping = aes(x = Territorio, y = IncidentiPerMlnAbitanti, color = Anno)) +
  geom_point() + 
  theme(axis.text.x=element_text(angle=45, hjust=1, vjust=0.5, margin = margin(t = -40, r = 0, b = 40, l = 0, unit = "pt")))
```




```{r, fig.width=9, fig.height=7, echo=FALSE, message=FALSE}
ggplot(data = RapportoIncidentiPopolazione %>% filter(Anno==2021), mapping = aes(x = nPopolazione, y = nIncidenti)) +
  geom_point() +
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(se = FALSE)
```



## Mappa incidenti in rapporto alla popolazione per provincia nel 2021

```{r, fig.width=8, fig.height=8, echo=FALSE, message=FALSE}
source("MapProvIncidentiPopolazione.R")

# Disegna la mappa con i colori
 ggplot() +
   geom_polygon(data = mappa_italia, aes(x = long, y = lat, group = group, fill = province), color = "black") +
   scale_fill_manual(values = ColoriProvince$colori) +
   theme_void() + theme(legend.position = "none") +     # per togliere assi, ecc dal grafico
   guides(color = guide_colorbar(title = "Valore"))
```



## Incidenti in rapporto al parco veicolare per regione nel 2021

```{r, echo=FALSE, message=FALSE}
source("ggplotIncidentiParcoveicolare.R")

ggplot(data = RapportoIncidentiVeicoli %>% filter(TIME==2021), mapping = aes(x = nVeicoli, y = nIncidenti)) +
  geom_point() +
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(se = FALSE)
```


## Mappa incidenti in rapporto al parco veicolare per provincia nel 2021

```{r, fig.width=8, fig.height=8, echo=FALSE, message=FALSE}
source("MapProvIncidentiParcoveicolare.R")

# Disegna la mappa con i colori
 ggplot() +
   geom_polygon(data = mappa_italia, aes(x = long, y = lat, group = group, fill = province), color = "black") +
   scale_fill_manual(values = ColoriProvince$colori) +
   theme_void() + theme(legend.position = "none") +     # per togliere assi, ecc dal grafico
   guides(color = guide_colorbar(title = "Valore"))
```



## Quantità di incidenti per fascia oraria
### Somma dei valori di tutti gli anni dal 2001 al 2021

```{r, fig.width=8, fig.height=7, echo=FALSE, message=FALSE}
# crea grafico con gli incidenti nelle varie fasce orarie (somma di tutti gli anni dal 2001 al 2021)
ggplot(data = IncidentiPerOrarioItalia %>% select(Territorio, ORA, Value) %>% group_by(ORA), 
       mapping = aes(x = ORA, y = Value)) +
  geom_col() +
  xlab("Fascia oraria") +
  ylab("Numero incidenti")
```



### Negli anni 2001, 2011 e 2021

```{r, fig.width=8, fig.height=7, echo=FALSE, message=FALSE}
# Crea grafico con gli incidenti nelle varie fascie orarie filtrati per i tre anni simbolici (2001, 2011, 2021)
ggplot(data = IncidentiPerOrarioItalia %>% filter(TIME %in% c(2001, 2011, 2021)), 
       mapping = aes(x = ORA, y = Value, color = TIME)) +
  geom_point()
```



## Quantità di incidenti per giorno della settimana (somma di tutti gli anni dal 2001 al 2021)

```{r, fig.width=8, fig.height=7, echo=FALSE, message=FALSE}
# Riordina i giorni della settimana nel modo desiderato
IncidentiPerGiornoItalia$Giorno.della.settimana = factor(IncidentiPerGiornoItalia$Giorno.della.settimana, levels = c("lunedì", "martedì", "mercoledì", "giovedì", "venerdì", "sabato", "domenica"))

# Crea grafico con gli incidenti nei vari giorni della settimana (somma di tutti gli anni dal 2001 al 2021)
ggplot(data = IncidentiPerGiornoItalia %>% select(Territorio, Giorno.della.settimana, Value) %>% group_by(Giorno.della.settimana), 
       mapping = aes(x = Giorno.della.settimana, y = Value)) +
  geom_col() +
  xlab("Giorno della settimana") +
  ylab("Numero incidenti")
```
